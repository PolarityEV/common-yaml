# Polarity Error Code Definitions
# Single source of truth for error codes across all platforms
# Supports: C (STM32), C (ESP32), Dart (Flutter)
#
# Version 2.7.0 - Hardware-Agnostic Error Codes (2025-11-01)
# BREAKING CHANGE: Error codes renamed to hardware-agnostic terminology
# - RENAMED: ESP32_* → GATEWAY_* (6 error codes: 0x0080-0x0087)
# - RENAMED: Source ID "ESP32_GATEWAY" → "BLE_GATEWAY"
# - RENAMED: Category "BLE" → "GATEWAY"
# - UPDATED: All error descriptions to remove hardware-specific names (RP2350, ESP32, etc.)
# REASON: Support future hardware revisions without firmware changes
# IMPACT: ESP32 firmware update REQUIRED (error code names changed)
# MIGRATION: Regenerate polarity_errors.h/.dart from updated definitions.yaml
#
# Version 2.6.0 - CAN-Bus-Based Error Code Refactoring (2025-10-30)
# BREAKING CHANGE: All component error codes now use CAN bus identification
# - RENAMED: CHARGER1_* → CHARGER_CAN2_* (charger on CAN2 bus)
# - RENAMED: CHARGER2_* → CHARGER_CAN3_* (charger on CAN3 bus)
# - ADDED: CHARGER_CAN1_* error codes (reserved for future hardware)
# - RENAMED: CURRENT_SENSOR1_* → CURRENT_SENSOR_CAN3_* (sensor on CAN3)
# - RENAMED: CURRENT_SENSOR2_* → CURRENT_SENSOR_CAN2_* (reserved, future hardware)
# - RENAMED: CURRENT_SENSOR3_* → CURRENT_SENSOR_CAN1_* (reserved, future hardware)
# - RENAMED: IMD_* → IMD_CAN3_* (IMD on CAN3 bus)
# - ADDED: IMD_CAN2_* error codes (0x00A2-0x00A6, reserved for future hardware)
# - ADDED: IMD_CAN1_* error codes (0x00A7-0x00AB, reserved for future hardware)
# REASON: CAN bus topology provides clearer identification than arbitrary instance numbers
# IMPACT: ESP32 firmware update REQUIRED (error code names changed)
# MIGRATION: Component detection system gates timeout errors for missing hardware
#
# Version 2.5.0 - Insulation Monitoring Device (IMD) Support (2025-10-29)
# NEW: Added IMD error codes (0x009D-0x00A1) for insulation monitoring
# - IMD_TIMEOUT: Communication timeout (>1s)
# - IMD_ISOLATION_ALARM: Critical isolation fault (R_iso < 100kΩ)
# - IMD_ISOLATION_WARNING: Isolation warning (R_iso < 500kΩ)
# - IMD_DEVICE_ERROR: Device fault or initialization stuck
# - IMD_CONNECTION_FAILURE: HV+/HV-/Earth connection fault
# REASON: Mandatory safety device for monitoring HV system isolation to chassis
# INTEGRATION: IMD on CAN3 @ 500 kbps, IMD_Info_General @ 100ms
#
# Version 2.4.1 - Remove Diagnostic Control Watchdog (2025-10-25)
# CHANGE: Removed 5-second diagnostic control watchdog (caused unwanted resets)
# - REMOVED: VCU_DIAGNOSTIC_CONTROL_TIMEOUT error code (0x0095)
# - REMOVED: DiagnosticControlLastWriteMs timestamp tracking
# - REMOVED: Watchdog check in GenericVCUTask
# - REASON: Diagnostic controls should persist until explicitly changed by app
# - IMPACT: Controls no longer auto-reset after 5 seconds of inactivity
#
# Version 2.4.0 - Hardware Cleanup (2025-10-25)
# CHANGE: Removed unused timer error codes after gauge cluster externalization
# - REMOVED: TIM2, TIM3, TIM11, TIM13 error codes (0x0022, 0x0023, 0x002B, 0x002D)
# - REMOVED: Duplicate TIM5 error code (0x009C) - now at 0x0025 only
# - UPDATED: Timer/UART descriptions now specify actual hardware usage
# - REASON: Gauge cluster moved to external board, timers TIM2/3/11/13 disabled in CubeMX
# - ACTIVE TIMERS: TIM1 (HAL timebase), TIM4 (water pump PWM), TIM5 (air con PWM)
#
# Version 2.3.0 - Simplified System Diagnostics
# CHANGE: Removed IDLE task detection (configUSE_IDLE_HOOK removed from FreeRTOS)
# - REMOVED: SYSTEM_CPU_STATS_FAILED error code (0x007B) - IDLE task tracking no longer used
# - REASON: CubeMX middleware doesn't expose IDLE task, CPU stats unreliable
# - MIGRATION: System diagnostics now reports generic statistics (uptime, heap, task count)
#
# Version 2.2.0 - UART Protocol Migration
# BREAKING CHANGE: I2C protocol replaced with UART protocol (I2C error codes deprecated)
# - REMOVED: All I2C error codes (I2C_*, 0x0001-0x0007, 0x0071, 0x0076, 0x007C-0x0090)
# - NEW: UART protocol error codes (UART_PROTOCOL_*, 0x0091-0x0094)
# - REASON: STM32F413 I2C dual-address silicon bug (ACK not recognized)
# - MIGRATION: VCU Protocol v11.0 uses UART (460800 baud, IDLE detection, length-prefixed messages)

# ============================================================
# Error Code Ranges (Quick Reference)
# ============================================================
# 0x0008-0x0020: CAN bus errors (initialization, queue, transmission)
# 0x0021-0x00AB: VCU peripherals and system (timers, UART, IMD, etc.)
# 0x0031-0x0041: BMS faults (undervoltage, overvoltage, isolation)
# 0x0042-0x0056: Charger faults (OBC + DCDC, CAN1/CAN2/CAN3)
# 0x0059-0x006C: Motor controller faults (LDU errors from stm32-sine)
# 0x006D-0x007A: Current sensors (CAN1/CAN2/CAN3, timeout/power faults)
# 0x0080-0x0087: BLE Gateway communication (UART bridge errors)
# 0x0088-0x008E: J1772 charge port (safety interlocks, autodetection)
# 0x009D-0x00A1: Insulation monitoring device (IMD, CAN3)
# ============================================================

project_name: "Polarity"
prefix: "POLARITY_ERR"
version: "2.5.0"

# Error Source Tracking (for app team visibility)
sources:
  - id: "STM32_VCU"
    description: "STM32 Vehicle Control Unit"
    location: "Main VCU firmware"

  - id: "LDU_MOTOR"
    description: "Large Drive Unit Motor Controller"
    location: "stm32-sine firmware (temporary)"
    note: "Will be replaced by STM32-HAL-LDU in future"

  - id: "BLE_GATEWAY"
    description: "BLE Gateway"
    location: "BLE Gateway firmware"

# Error codes are now 16-bit with sequential numbering
# Format: Explicit hexadecimal strings (e.g., "0x0001")
# Range: 0x0000-0xFFFF (0-65535)
categories:
  CAN:
    description: "CAN bus communication and peripheral errors"
    source: "STM32_VCU"
    errors:
      - name: "CAN1_INIT"
        code: "0x0008"
        description: "CAN1 initialization failed"
        severity: "critical"

      - name: "CAN2_INIT"
        code: "0x0009"
        description: "CAN2 initialization failed"
        severity: "critical"

      - name: "CAN3_INIT"
        code: "0x000A"
        description: "CAN3 initialization failed"
        severity: "critical"

      - name: "CAN1_FILTER"
        code: "0x000B"
        description: "CAN1 filter configuration failed"
        severity: "error"

      - name: "CAN2_FILTER"
        code: "0x000C"
        description: "CAN2 filter configuration failed"
        severity: "error"

      - name: "CAN3_FILTER"
        code: "0x000D"
        description: "CAN3 filter configuration failed"
        severity: "error"

      - name: "CAN1_EN"
        code: "0x000E"
        description: "CAN1 enable/start failed"
        severity: "critical"

      - name: "CAN2_EN"
        code: "0x000F"
        description: "CAN2 enable/start failed"
        severity: "critical"

      - name: "CAN3_EN"
        code: "0x0010"
        description: "CAN3 enable/start failed"
        severity: "critical"

      - name: "CAN1_NOTIFICATION"
        code: "0x0011"
        description: "CAN1 notification activation failed"
        severity: "error"

      - name: "CAN2_NOTIFICATION"
        code: "0x0012"
        description: "CAN2 notification activation failed"
        severity: "error"

      - name: "CAN3_NOTIFICATION"
        code: "0x0013"
        description: "CAN3 notification activation failed"
        severity: "error"

      - name: "CAN_RX_FIFO0"
        code: "0x0014"
        description: "CAN RX FIFO0 error"
        severity: "warning"

      - name: "CAN_RX_FIFO1"
        code: "0x0015"
        description: "CAN RX FIFO1 error"
        severity: "warning"

      - name: "CAN_RX_MSG"
        code: "0x0016"
        description: "CAN receive message failed"
        severity: "error"

      - name: "CAN_QUEUE_FULL"
        code: "0x0017"
        description: "CAN message queue overflow (messages dropped)"
        severity: "error"

      - name: "CAN1_RX_MSG"
        code: "0x0018"
        description: "CAN1 receive message failed"
        severity: "error"

      - name: "CAN2_RX_MSG"
        code: "0x0019"
        description: "CAN2 receive message failed"
        severity: "error"

      - name: "CAN3_RX_MSG"
        code: "0x001A"
        description: "CAN3 receive message failed"
        severity: "error"

      - name: "CAN4_RX_MSG"
        code: "0x001B"
        description: "CAN4 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN5_RX_MSG"
        code: "0x001C"
        description: "CAN5 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN_RESERVED"
        code: "0x001D"
        description: "Reserved for future CAN errors"
        severity: "info"

      - name: "CAN1_TX_MSG"
        code: "0x001E"
        description: "CAN1 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CAN2_TX_MSG"
        code: "0x001F"
        description: "CAN2 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CAN3_TX_MSG"
        code: "0x0020"
        description: "CAN3 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CHARGER_CAN2_TX_FAIL"
        code: "0x0044"
        description: "Charger on CAN2 transmission failed"
        severity: "warning"

      - name: "CHARGER_CAN3_TX_FAIL"
        code: "0x0049"
        description: "Charger on CAN3 transmission failed"
        severity: "warning"

      - name: "CHARGER_CAN1_TX_FAIL"
        code: "0x004E"
        description: "Charger on CAN1 transmission failed [Reserved for future hardware]"
        severity: "warning"

      - name: "CHARGER_RESERVED_TX_FAIL"
        code: "0x0053"
        description: "Charger 4 CAN transmission failed [Reserved]"
        severity: "warning"

  VCU:
    description: "Vehicle Control Unit peripheral and system errors (UART, TIM, system-level)"
    source: "STM32_VCU"
    errors:
      # ============================================================================
      # DEPRECATED I2C ERROR CODES (v2.1.0 and earlier)
      # Reserved for backward compatibility - DO NOT REUSE
      # Reason: STM32F413 I2C dual-address silicon bug (replaced with UART protocol v11.0)
      # ============================================================================
      # 0x0001-0x0007: I2C basic errors (SLAVE_TX, SLAVE_RX, LISTEN, ERR_CBK, TX_CPLT, RX_CPLT, ENABLE)
      # 0x0071: I2C_BUSY_TIMEOUT
      # 0x0076: I2C_DMA_NOT_READY
      # 0x007C-0x007D: I2C_DMA_RX_UNDERRUN, I2C_DMA_RX_OVERRUN
      # 0x0087-0x0090: I2C protocol and recovery errors
      # ============================================================================

      # ============================================================================
      # UART PROTOCOL V11.0 ERROR CODES (NEW in v2.2.0)
      # ============================================================================
      - name: "UART_PROTOCOL_INIT"
        code: "0x0091"
        description: "UART protocol v11.0 initialization failed (DMA start failed)"
        severity: "critical"

      - name: "UART_RX_OVERFLOW"
        code: "0x0092"
        description: "UART RX buffer overflow or DMA error"
        severity: "error"

      - name: "UART_INVALID_LENGTH"
        code: "0x0093"
        description: "UART message length mismatch (declared vs actual)"
        severity: "error"

      - name: "UART_INVALID_COMMAND"
        code: "0x0094"
        description: "UART unknown command received (not in dispatch table)"
        severity: "error"

      # ============================================================================
      # VCU DIAGNOSTIC CONTROL ERROR CODES (NEW in v2.4.0)
      # ============================================================================
      # 0x0095: VCU_DIAGNOSTIC_CONTROL_TIMEOUT - Removed in v2.4.1 (watchdog removed)
      #         No longer needed - diagnostic controls persist until changed by app

      - name: "VCU_DIAGNOSTIC_CONTACTOR_DENIED"
        code: "0x0096"
        description: "Diagnostic contactor enable denied (charging fault state active)"
        severity: "warning"

      - name: "VCU_DIAGNOSTIC_WPUMP_DUTY_INVALID"
        code: "0x0097"
        description: "Diagnostic water pump duty invalid (must be 0-100%)"
        severity: "warning"

      # ============================================================================
      # TIMER ERROR CODES (Active timers only)
      # TIM1: FreeRTOS HAL timebase (shares TIM1_UP_TIM10_IRQn vector)
      # TIM4: Water pump PWM (CH3, 100Hz, PD14)
      # TIM5: Air conditioning PWM (CH4, 150Hz, PA3)
      # Note: TIM2/3/10/11/13 removed in hardware cleanup (2025-10-25)
      # ============================================================================
      - name: "HAL_TIMEBASE_INIT"
        code: "0x0021"
        description: "FreeRTOS HAL timebase initialization failed (TIM1_UP_TIM10_IRQn)"
        severity: "critical"

      - name: "TIM4"
        code: "0x0024"
        description: "TIM4 PWM initialization failed (water pump control, CH3)"
        severity: "error"

      - name: "TIM5"
        code: "0x0025"
        description: "TIM5 PWM initialization failed (air conditioning control, CH4)"
        severity: "error"

      # ============================================================================
      # UART ERROR CODES (Active UARTs only)
      # UART1: FTDI debug console (PB6/PB7, 115200 baud)
      # UART2: ESP32 gateway protocol v11.0 (PD5/PD6, 460800 baud, DMA)
      # ============================================================================
      - name: "UART1"
        code: "0x002E"
        description: "UART1 operation failed (debug console)"
        severity: "error"

      - name: "UART2"
        code: "0x002F"
        description: "UART2 operation failed (ESP32 gateway protocol)"
        severity: "error"

      - name: "VCU_INIT"
        code: "0x0098"
        description: "VCU initialization failed"
        severity: "critical"

      - name: "FREERTOS_TASK_CREATE"
        code: "0x0099"
        description: "FreeRTOS task creation failed (insufficient heap memory)"
        severity: "critical"

      - name: "MEMORY_ALLOC"
        code: "0x009A"
        description: "Memory allocation failed (malloc returned NULL)"
        severity: "critical"

      - name: "DCDC"
        code: "0x009B"
        description: "DC-DC converter error"
        severity: "critical"

      # ============================================================================
      # INSULATION MONITORING DEVICE (IMD) ERROR CODES - CAN-bus-based (v2.5.0+)
      # IMD on CAN3: 0x009D-0x00A1
      # IMD on CAN2: 0x00A2-0x00A6
      # IMD on CAN1: 0x00A7-0x00AB
      # ============================================================================
      - name: "IMD_CAN3_TIMEOUT"
        code: "0x009D"
        description: "IMD on CAN3 communication timeout (>1s no CAN messages)"
        severity: "critical"

      - name: "IMD_CAN3_ISOLATION_ALARM"
        code: "0x009E"
        description: "IMD on CAN3 isolation alarm (R_iso < error threshold, default 100kΩ)"
        severity: "critical"

      - name: "IMD_CAN3_ISOLATION_WARNING"
        code: "0x009F"
        description: "IMD on CAN3 isolation warning (R_iso < warning threshold, default 500kΩ)"
        severity: "warning"

      - name: "IMD_CAN3_DEVICE_ERROR"
        code: "0x00A0"
        description: "IMD on CAN3 device error or stuck in initialization"
        severity: "error"

      - name: "IMD_CAN3_CONNECTION_FAILURE"
        code: "0x00A1"
        description: "IMD on CAN3 connection failure (HV+/HV-/Earth fault detected)"
        severity: "error"

      - name: "IMD_CAN2_TIMEOUT"
        code: "0x00A2"
        description: "IMD on CAN2 communication timeout (>1s no CAN messages) [Reserved for future hardware]"
        severity: "critical"

      - name: "IMD_CAN2_ISOLATION_ALARM"
        code: "0x00A3"
        description: "IMD on CAN2 isolation alarm (R_iso < error threshold, default 100kΩ) [Reserved for future hardware]"
        severity: "critical"

      - name: "IMD_CAN2_ISOLATION_WARNING"
        code: "0x00A4"
        description: "IMD on CAN2 isolation warning (R_iso < warning threshold, default 500kΩ) [Reserved for future hardware]"
        severity: "warning"

      - name: "IMD_CAN2_DEVICE_ERROR"
        code: "0x00A5"
        description: "IMD on CAN2 device error or stuck in initialization [Reserved for future hardware]"
        severity: "error"

      - name: "IMD_CAN2_CONNECTION_FAILURE"
        code: "0x00A6"
        description: "IMD on CAN2 connection failure (HV+/HV-/Earth fault detected) [Reserved for future hardware]"
        severity: "error"

      - name: "IMD_CAN1_TIMEOUT"
        code: "0x00A7"
        description: "IMD on CAN1 communication timeout (>1s no CAN messages) [Reserved for future hardware]"
        severity: "critical"

      - name: "IMD_CAN1_ISOLATION_ALARM"
        code: "0x00A8"
        description: "IMD on CAN1 isolation alarm (R_iso < error threshold, default 100kΩ) [Reserved for future hardware]"
        severity: "critical"

      - name: "IMD_CAN1_ISOLATION_WARNING"
        code: "0x00A9"
        description: "IMD on CAN1 isolation warning (R_iso < warning threshold, default 500kΩ) [Reserved for future hardware]"
        severity: "warning"

      - name: "IMD_CAN1_DEVICE_ERROR"
        code: "0x00AA"
        description: "IMD on CAN1 device error or stuck in initialization [Reserved for future hardware]"
        severity: "error"

      - name: "IMD_CAN1_CONNECTION_FAILURE"
        code: "0x00AB"
        description: "IMD on CAN1 connection failure (HV+/HV-/Earth fault detected) [Reserved for future hardware]"
        severity: "error"

      # ============================================================================
      # DEPRECATED ERROR CODES
      # ============================================================================
      # 0x007B: SYSTEM_CPU_STATS_FAILED - IDLE task detection removed (v2.3.0)
      #         (CubeMX middleware doesn't expose IDLE task, CPU stats unreliable)
      # 0x009C: TIM5 - Duplicate removed (v2.4.0), now at 0x0025 with other timer codes
      # 0x0022-0x0023: TIM2, TIM3 - Removed (v2.4.0), timers disabled in hardware cleanup
      # 0x0026-0x002D: TIM6-TIM13 - Removed (v2.4.0), timers disabled in hardware cleanup
      #         Note: 0x0021 repurposed from TIM1 to HAL_TIMEBASE_INIT (more accurate)
      # ============================================================================

  BMS:
    description: "BMS communication timeouts and battery pack faults"
    source: "STM32_VCU"
    errors:
      - name: "BMS1"
        code: "0x0031"
        description: "BMS1 communication or fault"
        severity: "critical"

      - name: "BMS2"
        code: "0x0032"
        description: "BMS2 communication or fault"
        severity: "critical"

      - name: "BMS1_OVERVOLTAGE"
        code: "0x0033"
        description: "BMS1 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS1_UNDERVOLTAGE"
        code: "0x0034"
        description: "BMS1 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS1_EXCESSIVE_DELTA"
        code: "0x0035"
        description: "BMS1 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS1_DATA_FAULT"
        code: "0x0036"
        description: "BMS1 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS1_TIMEOUT"
        code: "0x0037"
        description: "BMS1 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS2_OVERVOLTAGE"
        code: "0x0038"
        description: "BMS2 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS2_UNDERVOLTAGE"
        code: "0x0039"
        description: "BMS2 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS2_EXCESSIVE_DELTA"
        code: "0x003A"
        description: "BMS2 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS2_DATA_FAULT"
        code: "0x003B"
        description: "BMS2 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS2_TIMEOUT"
        code: "0x003C"
        description: "BMS2 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS3_OVERVOLTAGE"
        code: "0x003D"
        description: "BMS3 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS3_UNDERVOLTAGE"
        code: "0x003E"
        description: "BMS3 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS3_EXCESSIVE_DELTA"
        code: "0x003F"
        description: "BMS3 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS3_DATA_FAULT"
        code: "0x0040"
        description: "BMS3 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS3_TIMEOUT"
        code: "0x0041"
        description: "BMS3 communication timeout (no response to wake-up signals)"
        severity: "error"

  CHARGER:
    description: "Charger and charging system errors (CAN-bus-based identification)"
    source: "STM32_VCU"
    errors:
      - name: "CHARGER_CAN2_OBC_TIMEOUT"
        code: "0x0042"
        description: "Charger on CAN2 OBC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER_CAN2_DCDC_TIMEOUT"
        code: "0x0043"
        description: "Charger on CAN2 DCDC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER_CAN2_OBC_FAULT"
        code: "0x0045"
        description: "Charger on CAN2 OBC hardware or temperature fault"
        severity: "error"

      - name: "CHARGER_CAN2_DCDC_FAULT"
        code: "0x0046"
        description: "Charger on CAN2 DCDC hardware fault"
        severity: "error"

      - name: "CHARGER_CAN3_OBC_TIMEOUT"
        code: "0x0047"
        description: "Charger on CAN3 OBC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER_CAN3_DCDC_TIMEOUT"
        code: "0x0048"
        description: "Charger on CAN3 DCDC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER_CAN3_OBC_FAULT"
        code: "0x004A"
        description: "Charger on CAN3 OBC hardware or temperature fault"
        severity: "error"

      - name: "CHARGER_CAN3_DCDC_FAULT"
        code: "0x004B"
        description: "Charger on CAN3 DCDC hardware fault"
        severity: "error"

      - name: "CHARGER_CAN1_OBC_TIMEOUT"
        code: "0x004C"
        description: "Charger on CAN1 OBC communication timeout (>1s) [Reserved for future hardware]"
        severity: "error"

      - name: "CHARGER_CAN1_DCDC_TIMEOUT"
        code: "0x004D"
        description: "Charger on CAN1 DCDC communication timeout (>1s) [Reserved for future hardware]"
        severity: "error"

      - name: "CHARGER_CAN1_OBC_FAULT"
        code: "0x004F"
        description: "Charger on CAN1 OBC hardware or temperature fault [Reserved for future hardware]"
        severity: "error"

      - name: "CHARGER_CAN1_DCDC_FAULT"
        code: "0x0050"
        description: "Charger on CAN1 DCDC hardware fault [Reserved for future hardware]"
        severity: "error"

      - name: "CHARGER_RESERVED_OBC_TIMEOUT"
        code: "0x0051"
        description: "Reserved for additional charger OBC timeout"
        severity: "error"

      - name: "CHARGER_RESERVED_DCDC_TIMEOUT"
        code: "0x0052"
        description: "Reserved for additional charger DCDC timeout"
        severity: "error"

      - name: "CHARGER_RESERVED_OBC_FAULT"
        code: "0x0054"
        description: "Reserved for additional charger OBC fault"
        severity: "error"

      - name: "CHARGER_RESERVED_DCDC_FAULT"
        code: "0x0055"
        description: "Reserved for additional charger DCDC fault"
        severity: "error"

      - name: "CHARGER_IGNITION_ON"
        code: "0x0056"
        description: "Charging blocked: ignition ON (vehicle operational)"
        severity: "critical"

      - name: "CHARGER_NOT_NEUTRAL"
        code: "0x0057"
        description: "Charging blocked: transmission not in neutral"
        severity: "critical"

      - name: "CHARGER_VEHICLE_MOVING"
        code: "0x0058"
        description: "Charging blocked: vehicle moving (RPM detected)"
        severity: "critical"

  MOTOR:
    description: "Motor controller and LDU errors"
    source: "LDU_MOTOR"
    errors:
      - name: "MOTOR_OVERCURRENT"
        code: "0x0059"
        description: "Motor phase overcurrent detected"
        severity: "critical"
        sine_error_code: 1
        sine_error_name: "ERR_OVERCURRENT"
        sine_error_type: "ERROR_STOP"
        action: "Motor will shut down immediately"

      - name: "MOTOR_THROTTLE1"
        code: "0x005A"
        description: "Throttle sensor 1 fault"
        severity: "warning"
        sine_error_code: 2
        sine_error_name: "ERR_THROTTLE1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_THROTTLE2"
        code: "0x005B"
        description: "Throttle sensor 2 fault"
        severity: "warning"
        sine_error_code: 3
        sine_error_name: "ERR_THROTTLE2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_CANTIMEOUT"
        code: "0x005C"
        description: "Motor CAN communication timeout"
        severity: "critical"
        sine_error_code: 4
        sine_error_name: "ERR_CANTIMEOUT"
        sine_error_type: "ERROR_STOP"
        action: "Check CAN bus connections"

      - name: "MOTOR_EMCYSTOP"
        code: "0x005D"
        description: "Emergency stop triggered"
        severity: "critical"
        sine_error_code: 5
        sine_error_name: "ERR_EMCYSTOP"
        sine_error_type: "ERROR_STOP"
        action: "Check emergency stop circuit"

      - name: "MOTOR_MPROT"
        code: "0x005E"
        description: "Motor protection fault"
        severity: "critical"
        sine_error_code: 6
        sine_error_name: "ERR_MPROT"
        sine_error_type: "ERROR_STOP"
        action: "Motor protection triggered"

      - name: "MOTOR_DESAT"
        code: "0x005F"
        description: "Desaturation fault"
        severity: "critical"
        sine_error_code: 7
        sine_error_name: "ERR_DESAT"
        sine_error_type: "ERROR_STOP"
        action: "IGBT desaturation detected"

      - name: "MOTOR_OVERVOLTAGE"
        code: "0x0060"
        description: "DC bus overvoltage"
        severity: "critical"
        sine_error_code: 8
        sine_error_name: "ERR_OVERVOLTAGE"
        sine_error_type: "ERROR_STOP"
        action: "DC bus voltage too high"

      - name: "MOTOR_ENCODER"
        code: "0x0061"
        description: "Encoder failure"
        severity: "warning"
        sine_error_code: 9
        sine_error_name: "ERR_ENCODER"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder connections"

      - name: "MOTOR_PRECHARGE"
        code: "0x0062"
        description: "Precharge fault"
        severity: "critical"
        sine_error_code: 10
        sine_error_name: "ERR_PRECHARGE"
        sine_error_type: "ERROR_STOP"
        action: "Precharge circuit failed"

      - name: "MOTOR_TMPHSMAX"
        code: "0x0063"
        description: "Heatsink overtemperature"
        severity: "warning"
        sine_error_code: 11
        sine_error_name: "ERR_TMPHSMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CURRENTLIMIT"
        code: "0x0064"
        description: "Current limit active"
        severity: "warning"
        sine_error_code: 12
        sine_error_name: "ERR_CURRENTLIMIT"
        sine_error_type: "ERROR_DERATE"
        action: "Motor power limited"

      - name: "MOTOR_PWMSTUCK"
        code: "0x0065"
        description: "PWM stuck fault"
        severity: "warning"
        sine_error_code: 13
        sine_error_name: "ERR_PWMSTUCK"
        sine_error_type: "ERROR_DISPLAY"
        action: "PWM output failure"

      - name: "MOTOR_HICUROFS1"
        code: "0x0066"
        description: "Current sensor 1 offset high"
        severity: "warning"
        sine_error_code: 14
        sine_error_name: "ERR_HICUROFS1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 1"

      - name: "MOTOR_HICUROFS2"
        code: "0x0067"
        description: "Current sensor 2 offset high"
        severity: "warning"
        sine_error_code: 15
        sine_error_name: "ERR_HICUROFS2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 2"

      - name: "MOTOR_HIRESOFS"
        code: "0x0068"
        description: "High-res encoder offset fault"
        severity: "warning"
        sine_error_code: 16
        sine_error_name: "ERR_HIRESOFS"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate high-res encoder"

      - name: "MOTOR_LORESAMP"
        code: "0x0069"
        description: "Low-res encoder amplitude fault"
        severity: "warning"
        sine_error_code: 17
        sine_error_name: "ERR_LORESAMP"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder signal quality"

      - name: "MOTOR_TMPMMAX"
        code: "0x006A"
        description: "Motor overtemperature"
        severity: "warning"
        sine_error_code: 18
        sine_error_name: "ERR_TMPMMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CANCRC"
        code: "0x006B"
        description: "Motor CAN CRC error"
        severity: "critical"
        sine_error_code: 19
        sine_error_name: "ERR_CANCRC"
        sine_error_type: "ERROR_STOP"
        action: "CAN message corrupted"

      - name: "MOTOR_CANCOUNTER"
        code: "0x006C"
        description: "Motor CAN counter mismatch"
        severity: "critical"
        sine_error_code: 20
        sine_error_name: "ERR_CANCOUNTER"
        sine_error_type: "ERROR_STOP"
        action: "CAN message sequence error"

  SENSOR:
    description: "Sensor errors (current sensors, temperature sensors, etc.) - CAN-bus-based identification"
    source: "STM32_VCU"
    errors:
      - name: "CURRENT_SENSOR_CAN3_TIMEOUT"
        code: "0x006D"
        description: "Current Sensor on CAN3 communication timeout (>1s) [CAN ID 0x3C4]"
        severity: "error"

      - name: "CURRENT_SENSOR_CAN3_INVALID_DATA"
        code: "0x006E"
        description: "Current Sensor on CAN3 reports invalid current reading [CAN ID 0x3C4]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN3_OUT_OF_RANGE"
        code: "0x006F"
        description: "Current Sensor on CAN3 out of range (>±1550A) [CAN ID 0x3C4]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN3_POWER_FAULT"
        code: "0x0070"
        description: "Current Sensor on CAN3 power fault (under/over voltage or internal error) [CAN ID 0x3C4]"
        severity: "error"

      - name: "CURRENT_SENSOR_CAN2_TIMEOUT"
        code: "0x0072"
        description: "Current Sensor on CAN2 communication timeout (>1s) [Reserved for future hardware]"
        severity: "error"

      - name: "CURRENT_SENSOR_CAN2_INVALID_DATA"
        code: "0x0073"
        description: "Current Sensor on CAN2 reports invalid current reading [Reserved for future hardware]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN2_OUT_OF_RANGE"
        code: "0x0074"
        description: "Current Sensor on CAN2 out of range (>±1550A) [Reserved for future hardware]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN2_POWER_FAULT"
        code: "0x0075"
        description: "Current Sensor on CAN2 power fault (under/over voltage or internal error) [Reserved for future hardware]"
        severity: "error"

      - name: "CURRENT_SENSOR_CAN1_TIMEOUT"
        code: "0x0077"
        description: "Current Sensor on CAN1 communication timeout (>1s) [Reserved for future hardware]"
        severity: "error"

      - name: "CURRENT_SENSOR_CAN1_INVALID_DATA"
        code: "0x0078"
        description: "Current Sensor on CAN1 reports invalid current reading [Reserved for future hardware]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN1_OUT_OF_RANGE"
        code: "0x0079"
        description: "Current Sensor on CAN1 out of range (>±1550A) [Reserved for future hardware]"
        severity: "warning"

      - name: "CURRENT_SENSOR_CAN1_POWER_FAULT"
        code: "0x007A"
        description: "Current Sensor on CAN1 power fault (under/over voltage or internal error) [Reserved for future hardware]"
        severity: "error"

  GATEWAY:
    description: "BLE Gateway communication errors (UART bridge to VCU)"
    source: "BLE_GATEWAY"
    errors:
      - name: "GATEWAY_UART_TIMEOUT"
        code: "0x0080"
        description: "BLE Gateway UART timeout while communicating with VCU"
        severity: "warning"

      - name: "GATEWAY_UART_INVALID_RESPONSE"
        code: "0x0081"
        description: "Gateway received invalid response from VCU (length mismatch)"
        severity: "error"

      - name: "GATEWAY_UART_BUS_ERROR"
        code: "0x0082"
        description: "Gateway UART bus error (TX/RX fault)"
        severity: "error"

      - name: "GATEWAY_BLE_MBUF_ALLOC_FAIL"
        code: "0x0083"
        description: "BLE memory allocation failed (out of memory)"
        severity: "error"

      - name: "GATEWAY_UART_PROTOCOL_ERROR"
        code: "0x0084"
        description: "Gateway UART protocol error (invalid message format)"
        severity: "error"

      - name: "GATEWAY_VCU_WRITE_INVALID_CMD"
        code: "0x0085"
        description: "VCU rejected write command (unknown command ID)"
        severity: "error"
        note: "UART Protocol status 0x01 - check command byte"

      - name: "GATEWAY_VCU_WRITE_INVALID_LENGTH"
        code: "0x0086"
        description: "VCU rejected write command (payload too short)"
        severity: "error"
        note: "UART Protocol status 0x02 - check payload size"

      - name: "GATEWAY_VCU_WRITE_HANDLER_ERROR"
        code: "0x0087"
        description: "VCU rejected write command (validation failed)"
        severity: "warning"
        note: "UART Protocol status 0x03 - params out of range (e.g. duty>100)"

  # ============================================================
  # J1772 CHARGE PORT ERRORS (0x0088-0x008C)
  # ============================================================
  # SAE J1772 Electric Vehicle Coupler safety interlocks
  # Charge port controller monitors J1772 signals
  # CAN ID 0x200 @ 200ms (timeout 500ms = 2.5x period)
  # ============================================================
  J1772:
    description: "J1772 Charge Port safety interlocks"
    source: "STM32_VCU"
    errors:
      - name: "J1772_TIMEOUT"
        code: "0x0088"
        description: "Charge port controller timeout (>500ms)"
        severity: "error"
        note: "Check CAN connection to charge port controller, verify 0x200 message"

      - name: "J1772_INVALID_CP_STATE"
        code: "0x0089"
        description: "J1772 control pilot not in State C (charging not authorized)"
        severity: "error"
        note: "CP state must be C during charging (vehicle ready, EVSE energized)"

      - name: "J1772_PWM_OUT_OF_RANGE"
        code: "0x008A"
        description: "J1772 PWM duty cycle out of valid range (not 10-96%)"
        severity: "error"
        note: "PWM duty encodes EVSE current limit per SAE J1772 spec"

      - name: "J1772_AC_VOLTAGE_MISSING"
        code: "0x008B"
        description: "J1772 AC voltage not detected (EVSE not energized)"
        severity: "error"
        note: "AC voltage must be present for charging (120V or 240V)"

      - name: "J1772_PP_BUTTON_PRESSED"
        code: "0x008C"
        description: "J1772 proximity pilot button pressed (emergency disconnect)"
        severity: "warning"
        note: "User requesting disconnect - ramp down current gracefully"

      - name: "J1772_NOT_DETECTED"
        code: "0x008D"
        description: "J1772 charge port not detected during module detection window"
        severity: "error"
        note: "Charge port hardware missing or charge port controller firmware not running"

      - name: "J1772_VCU_WATCHDOG"
        code: "0x008E"
        description: "Charge port controller watchdog expired (VCU keepalive timeout)"
        severity: "error"
        note: "VCU must transmit CAN 0x201 keepalive every <5 seconds"
