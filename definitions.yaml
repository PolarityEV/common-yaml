# Polarity Error Code Definitions
# Single source of truth for error codes across all platforms
# Supports: C (STM32), C (ESP32), Dart (Flutter)
#
# Version 2.5.0 - Insulation Monitoring Device (IMD) Support (2025-10-29)
# NEW: Added IMD error codes (0x009D-0x00A1) for Bender ISO175 insulation monitoring
# - IMD_TIMEOUT: Communication timeout (>1s)
# - IMD_ISOLATION_ALARM: Critical isolation fault (R_iso < 100kΩ)
# - IMD_ISOLATION_WARNING: Isolation warning (R_iso < 500kΩ)
# - IMD_DEVICE_ERROR: Device fault or initialization stuck
# - IMD_CONNECTION_FAILURE: HV+/HV-/Earth connection fault
# REASON: Mandatory safety device for monitoring HV system isolation to chassis
# INTEGRATION: Bender ISO175 on CAN3 @ 500 kbps, IMD_Info_General @ 100ms
#
# Version 2.4.1 - Remove Diagnostic Control Watchdog (2025-10-25)
# CHANGE: Removed 5-second diagnostic control watchdog (caused unwanted resets)
# - REMOVED: VCU_DIAGNOSTIC_CONTROL_TIMEOUT error code (0x0095)
# - REMOVED: DiagnosticControlLastWriteMs timestamp tracking
# - REMOVED: Watchdog check in GenericVCUTask
# - REASON: Diagnostic controls should persist until explicitly changed by app
# - IMPACT: Controls no longer auto-reset after 5 seconds of inactivity
#
# Version 2.4.0 - Hardware Cleanup (2025-10-25)
# CHANGE: Removed unused timer error codes after gauge cluster externalization
# - REMOVED: TIM2, TIM3, TIM11, TIM13 error codes (0x0022, 0x0023, 0x002B, 0x002D)
# - REMOVED: Duplicate TIM5 error code (0x009C) - now at 0x0025 only
# - UPDATED: Timer/UART descriptions now specify actual hardware usage
# - REASON: Gauge cluster moved to external board, timers TIM2/3/11/13 disabled in CubeMX
# - ACTIVE TIMERS: TIM1 (HAL timebase), TIM4 (water pump PWM), TIM5 (air con PWM)
#
# Version 2.3.0 - Simplified System Diagnostics
# CHANGE: Removed IDLE task detection (configUSE_IDLE_HOOK removed from FreeRTOS)
# - REMOVED: SYSTEM_CPU_STATS_FAILED error code (0x007B) - IDLE task tracking no longer used
# - REASON: CubeMX middleware doesn't expose IDLE task, CPU stats unreliable
# - MIGRATION: System diagnostics now reports generic statistics (uptime, heap, task count)
#
# Version 2.2.0 - UART Protocol Migration
# BREAKING CHANGE: I2C protocol replaced with UART protocol (I2C error codes deprecated)
# - REMOVED: All I2C error codes (I2C_*, 0x0001-0x0007, 0x0071, 0x0076, 0x007C-0x0090)
# - NEW: UART protocol error codes (UART_PROTOCOL_*, 0x0091-0x0094)
# - REASON: STM32F413 I2C dual-address silicon bug (ACK not recognized)
# - MIGRATION: VCU Protocol v11.0 uses UART (460800 baud, IDLE detection, length-prefixed messages)

project_name: "Polarity"
prefix: "POLARITY_ERR"
version: "2.5.0"

# Error Source Tracking (for app team visibility)
sources:
  - id: "STM32_VCU"
    description: "STM32 Vehicle Control Unit"
    location: "Main VCU firmware"

  - id: "LDU_MOTOR"
    description: "Large Drive Unit Motor Controller"
    location: "stm32-sine firmware (temporary)"
    note: "Will be replaced by STM32-HAL-LDU in future"

  - id: "ESP32_GATEWAY"
    description: "ESP32 BLE Gateway"
    location: "ESP32 VCU Bridge firmware"

# Error codes are now 16-bit with sequential numbering
# Format: Explicit hexadecimal strings (e.g., "0x0001")
# Range: 0x0000-0xFFFF (0-65535)
categories:
  CAN:
    description: "CAN bus communication and peripheral errors"
    source: "STM32_VCU"
    errors:
      - name: "CAN1_INIT"
        code: "0x0008"
        description: "CAN1 initialization failed"
        severity: "critical"

      - name: "CAN2_INIT"
        code: "0x0009"
        description: "CAN2 initialization failed"
        severity: "critical"

      - name: "CAN3_INIT"
        code: "0x000A"
        description: "CAN3 initialization failed"
        severity: "critical"

      - name: "CAN1_FILTER"
        code: "0x000B"
        description: "CAN1 filter configuration failed"
        severity: "error"

      - name: "CAN2_FILTER"
        code: "0x000C"
        description: "CAN2 filter configuration failed"
        severity: "error"

      - name: "CAN3_FILTER"
        code: "0x000D"
        description: "CAN3 filter configuration failed"
        severity: "error"

      - name: "CAN1_EN"
        code: "0x000E"
        description: "CAN1 enable/start failed"
        severity: "critical"

      - name: "CAN2_EN"
        code: "0x000F"
        description: "CAN2 enable/start failed"
        severity: "critical"

      - name: "CAN3_EN"
        code: "0x0010"
        description: "CAN3 enable/start failed"
        severity: "critical"

      - name: "CAN1_NOTIFICATION"
        code: "0x0011"
        description: "CAN1 notification activation failed"
        severity: "error"

      - name: "CAN2_NOTIFICATION"
        code: "0x0012"
        description: "CAN2 notification activation failed"
        severity: "error"

      - name: "CAN3_NOTIFICATION"
        code: "0x0013"
        description: "CAN3 notification activation failed"
        severity: "error"

      - name: "CAN_RX_FIFO0"
        code: "0x0014"
        description: "CAN RX FIFO0 error"
        severity: "warning"

      - name: "CAN_RX_FIFO1"
        code: "0x0015"
        description: "CAN RX FIFO1 error"
        severity: "warning"

      - name: "CAN_RX_MSG"
        code: "0x0016"
        description: "CAN receive message failed"
        severity: "error"

      - name: "CAN_QUEUE_FULL"
        code: "0x0017"
        description: "CAN message queue overflow (messages dropped)"
        severity: "error"

      - name: "CAN1_RX_MSG"
        code: "0x0018"
        description: "CAN1 receive message failed"
        severity: "error"

      - name: "CAN2_RX_MSG"
        code: "0x0019"
        description: "CAN2 receive message failed"
        severity: "error"

      - name: "CAN3_RX_MSG"
        code: "0x001A"
        description: "CAN3 receive message failed"
        severity: "error"

      - name: "CAN4_RX_MSG"
        code: "0x001B"
        description: "CAN4 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN5_RX_MSG"
        code: "0x001C"
        description: "CAN5 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN_RESERVED"
        code: "0x001D"
        description: "Reserved for future CAN errors"
        severity: "info"

      - name: "CAN1_TX_MSG"
        code: "0x001E"
        description: "CAN1 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CAN2_TX_MSG"
        code: "0x001F"
        description: "CAN2 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CAN3_TX_MSG"
        code: "0x0020"
        description: "CAN3 transmit failed (mailbox full or bus error)"
        severity: "error"

      - name: "CHARGER1_TX_FAIL"
        code: "0x0044"
        description: "Charger 1 CAN transmission failed [CAN2]"
        severity: "warning"

      - name: "CHARGER2_TX_FAIL"
        code: "0x0049"
        description: "Charger 2 CAN transmission failed [CAN3]"
        severity: "warning"

      - name: "CHARGER3_TX_FAIL"
        code: "0x004E"
        description: "Charger 3 CAN transmission failed [Reserved]"
        severity: "warning"

      - name: "CHARGER4_TX_FAIL"
        code: "0x0053"
        description: "Charger 4 CAN transmission failed [Reserved]"
        severity: "warning"

  VCU:
    description: "Vehicle Control Unit peripheral and system errors (UART, TIM, system-level)"
    source: "STM32_VCU"
    errors:
      # ============================================================================
      # DEPRECATED I2C ERROR CODES (v2.1.0 and earlier)
      # Reserved for backward compatibility - DO NOT REUSE
      # Reason: STM32F413 I2C dual-address silicon bug (replaced with UART protocol v11.0)
      # ============================================================================
      # 0x0001-0x0007: I2C basic errors (SLAVE_TX, SLAVE_RX, LISTEN, ERR_CBK, TX_CPLT, RX_CPLT, ENABLE)
      # 0x0071: I2C_BUSY_TIMEOUT
      # 0x0076: I2C_DMA_NOT_READY
      # 0x007C-0x007D: I2C_DMA_RX_UNDERRUN, I2C_DMA_RX_OVERRUN
      # 0x0087-0x0090: I2C protocol and recovery errors
      # ============================================================================

      # ============================================================================
      # UART PROTOCOL V11.0 ERROR CODES (NEW in v2.2.0)
      # ============================================================================
      - name: "UART_PROTOCOL_INIT"
        code: "0x0091"
        description: "UART protocol v11.0 initialization failed (DMA start failed)"
        severity: "critical"

      - name: "UART_RX_OVERFLOW"
        code: "0x0092"
        description: "UART RX buffer overflow or DMA error"
        severity: "error"

      - name: "UART_INVALID_LENGTH"
        code: "0x0093"
        description: "UART message length mismatch (declared vs actual)"
        severity: "error"

      - name: "UART_INVALID_COMMAND"
        code: "0x0094"
        description: "UART unknown command received (not in dispatch table)"
        severity: "error"

      # ============================================================================
      # VCU DIAGNOSTIC CONTROL ERROR CODES (NEW in v2.4.0)
      # ============================================================================
      # 0x0095: VCU_DIAGNOSTIC_CONTROL_TIMEOUT - Removed in v2.4.1 (watchdog removed)
      #         No longer needed - diagnostic controls persist until changed by app

      - name: "VCU_DIAGNOSTIC_CONTACTOR_DENIED"
        code: "0x0096"
        description: "Diagnostic contactor enable denied (charging fault state active)"
        severity: "warning"

      - name: "VCU_DIAGNOSTIC_WPUMP_DUTY_INVALID"
        code: "0x0097"
        description: "Diagnostic water pump duty invalid (must be 0-100%)"
        severity: "warning"

      # ============================================================================
      # TIMER ERROR CODES (Active timers only)
      # TIM1: FreeRTOS HAL timebase (shares TIM1_UP_TIM10_IRQn vector)
      # TIM4: Water pump PWM (CH3, 100Hz, PD14)
      # TIM5: Air conditioning PWM (CH4, 150Hz, PA3)
      # Note: TIM2/3/10/11/13 removed in hardware cleanup (2025-10-25)
      # ============================================================================
      - name: "HAL_TIMEBASE_INIT"
        code: "0x0021"
        description: "FreeRTOS HAL timebase initialization failed (TIM1_UP_TIM10_IRQn)"
        severity: "critical"

      - name: "TIM4"
        code: "0x0024"
        description: "TIM4 PWM initialization failed (water pump control, CH3)"
        severity: "error"

      - name: "TIM5"
        code: "0x0025"
        description: "TIM5 PWM initialization failed (air conditioning control, CH4)"
        severity: "error"

      # ============================================================================
      # UART ERROR CODES (Active UARTs only)
      # UART1: FTDI debug console (PB6/PB7, 115200 baud)
      # UART2: ESP32 gateway protocol v11.0 (PD5/PD6, 460800 baud, DMA)
      # ============================================================================
      - name: "UART1"
        code: "0x002E"
        description: "UART1 operation failed (debug console)"
        severity: "error"

      - name: "UART2"
        code: "0x002F"
        description: "UART2 operation failed (ESP32 gateway protocol)"
        severity: "error"

      - name: "VCU_INIT"
        code: "0x0098"
        description: "VCU initialization failed"
        severity: "critical"

      - name: "FREERTOS_TASK_CREATE"
        code: "0x0099"
        description: "FreeRTOS task creation failed (insufficient heap memory)"
        severity: "critical"

      - name: "MEMORY_ALLOC"
        code: "0x009A"
        description: "Memory allocation failed (malloc returned NULL)"
        severity: "critical"

      - name: "DCDC"
        code: "0x009B"
        description: "DC-DC converter error"
        severity: "critical"

      # ============================================================================
      # INSULATION MONITORING DEVICE (IMD) ERROR CODES (NEW in v2.5.0)
      # ============================================================================
      - name: "IMD_TIMEOUT"
        code: "0x009D"
        description: "IMD communication timeout (>1s no CAN messages)"
        severity: "critical"

      - name: "IMD_ISOLATION_ALARM"
        code: "0x009E"
        description: "IMD isolation alarm (R_iso < error threshold, default 100kΩ)"
        severity: "critical"

      - name: "IMD_ISOLATION_WARNING"
        code: "0x009F"
        description: "IMD isolation warning (R_iso < warning threshold, default 500kΩ)"
        severity: "warning"

      - name: "IMD_DEVICE_ERROR"
        code: "0x00A0"
        description: "IMD device error or stuck in initialization"
        severity: "error"

      - name: "IMD_CONNECTION_FAILURE"
        code: "0x00A1"
        description: "IMD connection failure (HV+/HV-/Earth fault detected)"
        severity: "error"

      # ============================================================================
      # DEPRECATED ERROR CODES
      # ============================================================================
      # 0x007B: SYSTEM_CPU_STATS_FAILED - IDLE task detection removed (v2.3.0)
      #         (CubeMX middleware doesn't expose IDLE task, CPU stats unreliable)
      # 0x009C: TIM5 - Duplicate removed (v2.4.0), now at 0x0025 with other timer codes
      # 0x0022-0x0023: TIM2, TIM3 - Removed (v2.4.0), timers disabled in hardware cleanup
      # 0x0026-0x002D: TIM6-TIM13 - Removed (v2.4.0), timers disabled in hardware cleanup
      #         Note: 0x0021 repurposed from TIM1 to HAL_TIMEBASE_INIT (more accurate)
      # ============================================================================

  BMS:
    description: "BMS communication timeouts and battery pack faults"
    source: "STM32_VCU"
    errors:
      - name: "BMS1"
        code: "0x0031"
        description: "BMS1 communication or fault"
        severity: "critical"

      - name: "BMS2"
        code: "0x0032"
        description: "BMS2 communication or fault"
        severity: "critical"

      - name: "BMS1_OVERVOLTAGE"
        code: "0x0033"
        description: "BMS1 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS1_UNDERVOLTAGE"
        code: "0x0034"
        description: "BMS1 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS1_EXCESSIVE_DELTA"
        code: "0x0035"
        description: "BMS1 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS1_DATA_FAULT"
        code: "0x0036"
        description: "BMS1 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS1_TIMEOUT"
        code: "0x0037"
        description: "BMS1 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS2_OVERVOLTAGE"
        code: "0x0038"
        description: "BMS2 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS2_UNDERVOLTAGE"
        code: "0x0039"
        description: "BMS2 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS2_EXCESSIVE_DELTA"
        code: "0x003A"
        description: "BMS2 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS2_DATA_FAULT"
        code: "0x003B"
        description: "BMS2 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS2_TIMEOUT"
        code: "0x003C"
        description: "BMS2 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS3_OVERVOLTAGE"
        code: "0x003D"
        description: "BMS3 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS3_UNDERVOLTAGE"
        code: "0x003E"
        description: "BMS3 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS3_EXCESSIVE_DELTA"
        code: "0x003F"
        description: "BMS3 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS3_DATA_FAULT"
        code: "0x0040"
        description: "BMS3 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS3_TIMEOUT"
        code: "0x0041"
        description: "BMS3 communication timeout (no response to wake-up signals)"
        severity: "error"

  CHARGER:
    description: "Charger and charging system errors"
    source: "STM32_VCU"
    errors:
      - name: "CHARGER1_OBC_TIMEOUT"
        code: "0x0042"
        description: "Charger 1 OBC communication timeout (>1s) [CAN2]"
        severity: "error"

      - name: "CHARGER1_DCDC_TIMEOUT"
        code: "0x0043"
        description: "Charger 1 DCDC communication timeout (>1s) [CAN2]"
        severity: "error"

      - name: "CHARGER1_OBC_FAULT"
        code: "0x0045"
        description: "Charger 1 OBC hardware or temperature fault [CAN2]"
        severity: "error"

      - name: "CHARGER1_DCDC_FAULT"
        code: "0x0046"
        description: "Charger 1 DCDC hardware fault [CAN2]"
        severity: "error"

      - name: "CHARGER2_OBC_TIMEOUT"
        code: "0x0047"
        description: "Charger 2 OBC communication timeout (>1s) [CAN3]"
        severity: "error"

      - name: "CHARGER2_DCDC_TIMEOUT"
        code: "0x0048"
        description: "Charger 2 DCDC communication timeout (>1s) [CAN3]"
        severity: "error"

      - name: "CHARGER2_OBC_FAULT"
        code: "0x004A"
        description: "Charger 2 OBC hardware or temperature fault [CAN3]"
        severity: "error"

      - name: "CHARGER2_DCDC_FAULT"
        code: "0x004B"
        description: "Charger 2 DCDC hardware fault [CAN3]"
        severity: "error"

      - name: "CHARGER3_OBC_TIMEOUT"
        code: "0x004C"
        description: "Charger 3 OBC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER3_DCDC_TIMEOUT"
        code: "0x004D"
        description: "Charger 3 DCDC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER3_OBC_FAULT"
        code: "0x004F"
        description: "Charger 3 OBC hardware or temperature fault [Reserved]"
        severity: "error"

      - name: "CHARGER3_DCDC_FAULT"
        code: "0x0050"
        description: "Charger 3 DCDC hardware fault [Reserved]"
        severity: "error"

      - name: "CHARGER4_OBC_TIMEOUT"
        code: "0x0051"
        description: "Charger 4 OBC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER4_DCDC_TIMEOUT"
        code: "0x0052"
        description: "Charger 4 DCDC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER4_OBC_FAULT"
        code: "0x0054"
        description: "Charger 4 OBC hardware or temperature fault [Reserved]"
        severity: "error"

      - name: "CHARGER4_DCDC_FAULT"
        code: "0x0055"
        description: "Charger 4 DCDC hardware fault [Reserved]"
        severity: "error"

      - name: "CHARGER_IGNITION_ON"
        code: "0x0056"
        description: "Charging blocked: ignition ON (vehicle operational)"
        severity: "critical"

      - name: "CHARGER_NOT_NEUTRAL"
        code: "0x0057"
        description: "Charging blocked: transmission not in neutral"
        severity: "critical"

      - name: "CHARGER_VEHICLE_MOVING"
        code: "0x0058"
        description: "Charging blocked: vehicle moving (RPM detected)"
        severity: "critical"

  MOTOR:
    description: "Motor controller and LDU errors"
    source: "LDU_MOTOR"
    errors:
      - name: "MOTOR_OVERCURRENT"
        code: "0x0059"
        description: "Motor phase overcurrent detected"
        severity: "critical"
        sine_error_code: 1
        sine_error_name: "ERR_OVERCURRENT"
        sine_error_type: "ERROR_STOP"
        action: "Motor will shut down immediately"

      - name: "MOTOR_THROTTLE1"
        code: "0x005A"
        description: "Throttle sensor 1 fault"
        severity: "warning"
        sine_error_code: 2
        sine_error_name: "ERR_THROTTLE1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_THROTTLE2"
        code: "0x005B"
        description: "Throttle sensor 2 fault"
        severity: "warning"
        sine_error_code: 3
        sine_error_name: "ERR_THROTTLE2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_CANTIMEOUT"
        code: "0x005C"
        description: "Motor CAN communication timeout"
        severity: "critical"
        sine_error_code: 4
        sine_error_name: "ERR_CANTIMEOUT"
        sine_error_type: "ERROR_STOP"
        action: "Check CAN bus connections"

      - name: "MOTOR_EMCYSTOP"
        code: "0x005D"
        description: "Emergency stop triggered"
        severity: "critical"
        sine_error_code: 5
        sine_error_name: "ERR_EMCYSTOP"
        sine_error_type: "ERROR_STOP"
        action: "Check emergency stop circuit"

      - name: "MOTOR_MPROT"
        code: "0x005E"
        description: "Motor protection fault"
        severity: "critical"
        sine_error_code: 6
        sine_error_name: "ERR_MPROT"
        sine_error_type: "ERROR_STOP"
        action: "Motor protection triggered"

      - name: "MOTOR_DESAT"
        code: "0x005F"
        description: "Desaturation fault"
        severity: "critical"
        sine_error_code: 7
        sine_error_name: "ERR_DESAT"
        sine_error_type: "ERROR_STOP"
        action: "IGBT desaturation detected"

      - name: "MOTOR_OVERVOLTAGE"
        code: "0x0060"
        description: "DC bus overvoltage"
        severity: "critical"
        sine_error_code: 8
        sine_error_name: "ERR_OVERVOLTAGE"
        sine_error_type: "ERROR_STOP"
        action: "DC bus voltage too high"

      - name: "MOTOR_ENCODER"
        code: "0x0061"
        description: "Encoder failure"
        severity: "warning"
        sine_error_code: 9
        sine_error_name: "ERR_ENCODER"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder connections"

      - name: "MOTOR_PRECHARGE"
        code: "0x0062"
        description: "Precharge fault"
        severity: "critical"
        sine_error_code: 10
        sine_error_name: "ERR_PRECHARGE"
        sine_error_type: "ERROR_STOP"
        action: "Precharge circuit failed"

      - name: "MOTOR_TMPHSMAX"
        code: "0x0063"
        description: "Heatsink overtemperature"
        severity: "warning"
        sine_error_code: 11
        sine_error_name: "ERR_TMPHSMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CURRENTLIMIT"
        code: "0x0064"
        description: "Current limit active"
        severity: "warning"
        sine_error_code: 12
        sine_error_name: "ERR_CURRENTLIMIT"
        sine_error_type: "ERROR_DERATE"
        action: "Motor power limited"

      - name: "MOTOR_PWMSTUCK"
        code: "0x0065"
        description: "PWM stuck fault"
        severity: "warning"
        sine_error_code: 13
        sine_error_name: "ERR_PWMSTUCK"
        sine_error_type: "ERROR_DISPLAY"
        action: "PWM output failure"

      - name: "MOTOR_HICUROFS1"
        code: "0x0066"
        description: "Current sensor 1 offset high"
        severity: "warning"
        sine_error_code: 14
        sine_error_name: "ERR_HICUROFS1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 1"

      - name: "MOTOR_HICUROFS2"
        code: "0x0067"
        description: "Current sensor 2 offset high"
        severity: "warning"
        sine_error_code: 15
        sine_error_name: "ERR_HICUROFS2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 2"

      - name: "MOTOR_HIRESOFS"
        code: "0x0068"
        description: "High-res encoder offset fault"
        severity: "warning"
        sine_error_code: 16
        sine_error_name: "ERR_HIRESOFS"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate high-res encoder"

      - name: "MOTOR_LORESAMP"
        code: "0x0069"
        description: "Low-res encoder amplitude fault"
        severity: "warning"
        sine_error_code: 17
        sine_error_name: "ERR_LORESAMP"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder signal quality"

      - name: "MOTOR_TMPMMAX"
        code: "0x006A"
        description: "Motor overtemperature"
        severity: "warning"
        sine_error_code: 18
        sine_error_name: "ERR_TMPMMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CANCRC"
        code: "0x006B"
        description: "Motor CAN CRC error"
        severity: "critical"
        sine_error_code: 19
        sine_error_name: "ERR_CANCRC"
        sine_error_type: "ERROR_STOP"
        action: "CAN message corrupted"

      - name: "MOTOR_CANCOUNTER"
        code: "0x006C"
        description: "Motor CAN counter mismatch"
        severity: "critical"
        sine_error_code: 20
        sine_error_name: "ERR_CANCOUNTER"
        sine_error_type: "ERROR_STOP"
        action: "CAN message sequence error"

  SENSOR:
    description: "Sensor errors (current sensors, temperature sensors, etc.)"
    source: "STM32_VCU"
    errors:
      - name: "CURRENT_SENSOR1_TIMEOUT"
        code: "0x006D"
        description: "Current Sensor 1 communication timeout (>1s) [CAN3 0x3C4]"
        severity: "error"

      - name: "CURRENT_SENSOR1_INVALID_DATA"
        code: "0x006E"
        description: "Current Sensor 1 reports invalid current reading [CAN3 0x3C4]"
        severity: "warning"

      - name: "CURRENT_SENSOR1_OUT_OF_RANGE"
        code: "0x006F"
        description: "Current Sensor 1 out of range (>±1550A) [CAN3 0x3C4]"
        severity: "warning"

      - name: "CURRENT_SENSOR1_POWER_FAULT"
        code: "0x0070"
        description: "Current Sensor 1 power fault (under/over voltage or internal error) [CAN3 0x3C4]"
        severity: "error"

      - name: "CURRENT_SENSOR2_TIMEOUT"
        code: "0x0072"
        description: "Current Sensor 2 communication timeout (>1s) [CAN3 0x3C5] (Reserved)"
        severity: "error"

      - name: "CURRENT_SENSOR2_INVALID_DATA"
        code: "0x0073"
        description: "Current Sensor 2 reports invalid current reading [CAN3 0x3C5] (Reserved)"
        severity: "warning"

      - name: "CURRENT_SENSOR2_OUT_OF_RANGE"
        code: "0x0074"
        description: "Current Sensor 2 out of range (>±1550A) [CAN3 0x3C5] (Reserved)"
        severity: "warning"

      - name: "CURRENT_SENSOR2_POWER_FAULT"
        code: "0x0075"
        description: "Current Sensor 2 power fault (under/over voltage or internal error) [CAN3 0x3C5] (Reserved)"
        severity: "error"

      - name: "CURRENT_SENSOR3_TIMEOUT"
        code: "0x0077"
        description: "Current Sensor 3 communication timeout (>1s) [CAN3 0x3C6] (Reserved)"
        severity: "error"

      - name: "CURRENT_SENSOR3_INVALID_DATA"
        code: "0x0078"
        description: "Current Sensor 3 reports invalid current reading [CAN3 0x3C6] (Reserved)"
        severity: "warning"

      - name: "CURRENT_SENSOR3_OUT_OF_RANGE"
        code: "0x0079"
        description: "Current Sensor 3 out of range (>±1550A) [CAN3 0x3C6] (Reserved)"
        severity: "warning"

      - name: "CURRENT_SENSOR3_POWER_FAULT"
        code: "0x007A"
        description: "Current Sensor 3 power fault (under/over voltage or internal error) [CAN3 0x3C6] (Reserved)"
        severity: "error"

  BLE:
    description: "BLE Gateway communication errors (UART bridge to VCU)"
    source: "ESP32_GATEWAY"
    errors:
      - name: "ESP32_UART_TIMEOUT"
        code: "0x0080"
        description: "Gateway UART transaction timeout communicating with VCU"
        severity: "warning"

      - name: "ESP32_UART_INVALID_RESPONSE"
        code: "0x0081"
        description: "Gateway received invalid response from VCU (length mismatch)"
        severity: "error"

      - name: "ESP32_UART_BUS_ERROR"
        code: "0x0082"
        description: "Gateway UART bus error (TX/RX fault)"
        severity: "error"

      - name: "ESP32_BLE_MBUF_ALLOC_FAIL"
        code: "0x0083"
        description: "BLE memory allocation failed (out of memory)"
        severity: "error"

      - name: "ESP32_UART_PROTOCOL_ERROR"
        code: "0x0084"
        description: "Gateway UART protocol error (invalid message format)"
        severity: "error"

      - name: "ESP32_STM32_WRITE_INVALID_CMD"
        code: "0x0085"
        description: "STM32 rejected write command (unknown command ID)"
        severity: "error"
        note: "UART Protocol status 0x01 - check command byte"

      - name: "ESP32_STM32_WRITE_INVALID_LENGTH"
        code: "0x0086"
        description: "STM32 rejected write command (payload too short)"
        severity: "error"
        note: "UART Protocol status 0x02 - check payload size"

      - name: "ESP32_STM32_WRITE_HANDLER_ERROR"
        code: "0x0087"
        description: "STM32 rejected write command (validation failed)"
        severity: "warning"
        note: "UART Protocol status 0x03 - params out of range (e.g. duty>100)"
