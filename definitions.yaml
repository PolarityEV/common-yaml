# Polarity Error Code Definitions
# Single source of truth for error codes across all platforms
# Supports: C (STM32), C (ESP32), Dart (Flutter)
#
# Version 2.0.0 - 16-bit Error Code System
# Error codes are now 16-bit (0x0000-0xFFFF) with hexadecimal format
# BREAKING CHANGE: All error codes renumbered sequentially from 0x0001

project_name: "Polarity"
prefix: "POLARITY_ERR"
version: "2.0.0"

# Error Source Tracking (for app team visibility)
sources:
  - id: "STM32_VCU"
    description: "STM32 Vehicle Control Unit"
    location: "Main VCU firmware"

  - id: "LDU_MOTOR"
    description: "Large Drive Unit Motor Controller"
    location: "stm32-sine firmware (temporary)"
    note: "Will be replaced by STM32-HAL-LDU in future"

  - id: "ESP32_GATEWAY"
    description: "ESP32 BLE Gateway"
    location: "ESP32 VCU Bridge firmware"

# Error codes are now 16-bit with sequential numbering
# Format: Explicit hexadecimal strings (e.g., "0x0001")
# Range: 0x0000-0xFFFF (0-65535)
categories:
  I2C:
    description: "I2C communication errors"
    source: "STM32_VCU"
    errors:
      - name: "I2C_SLAVE_TX"
        code: "0x0001"
        description: "I2C slave transmit failed"
        severity: "error"

      - name: "I2C_SLAVE_RX"
        code: "0x0002"
        description: "I2C slave receive failed"
        severity: "error"

      - name: "I2C_LISTEN"
        code: "0x0003"
        description: "I2C listen mode activation failed"
        severity: "critical"

      - name: "I2C_ERR_CBK"
        code: "0x0004"
        description: "I2C error callback triggered"
        severity: "error"

      - name: "I2C_SLAVE_TX_CPLT"
        code: "0x0005"
        description: "I2C slave transmit complete with error"
        severity: "error"

      - name: "I2C_SLAVE_RX_CPLT"
        code: "0x0006"
        description: "I2C slave receive complete with error"
        severity: "error"

      - name: "I2C_ENABLE"
        code: "0x0007"
        description: "I2C enable failed"
        severity: "critical"

  CAN:
    description: "CAN bus communication errors"
    source: "STM32_VCU"
    errors:
      - name: "CAN1_INIT"
        code: "0x0008"
        description: "CAN1 initialization failed"
        severity: "critical"

      - name: "CAN2_INIT"
        code: "0x0009"
        description: "CAN2 initialization failed"
        severity: "critical"

      - name: "CAN3_INIT"
        code: "0x000A"
        description: "CAN3 initialization failed"
        severity: "critical"

      - name: "CAN1_FILTER"
        code: "0x000B"
        description: "CAN1 filter configuration failed"
        severity: "error"

      - name: "CAN2_FILTER"
        code: "0x000C"
        description: "CAN2 filter configuration failed"
        severity: "error"

      - name: "CAN3_FILTER"
        code: "0x000D"
        description: "CAN3 filter configuration failed"
        severity: "error"

      - name: "CAN1_EN"
        code: "0x000E"
        description: "CAN1 enable/start failed"
        severity: "critical"

      - name: "CAN2_EN"
        code: "0x000F"
        description: "CAN2 enable/start failed"
        severity: "critical"

      - name: "CAN3_EN"
        code: "0x0010"
        description: "CAN3 enable/start failed"
        severity: "critical"

      - name: "CAN1_NOTIFICATION"
        code: "0x0011"
        description: "CAN1 notification activation failed"
        severity: "error"

      - name: "CAN2_NOTIFICATION"
        code: "0x0012"
        description: "CAN2 notification activation failed"
        severity: "error"

      - name: "CAN3_NOTIFICATION"
        code: "0x0013"
        description: "CAN3 notification activation failed"
        severity: "error"

      - name: "CAN_RX_FIFO0"
        code: "0x0014"
        description: "CAN RX FIFO0 error"
        severity: "warning"

      - name: "CAN_RX_FIFO1"
        code: "0x0015"
        description: "CAN RX FIFO1 error"
        severity: "warning"

      - name: "CAN_RX_MSG"
        code: "0x0016"
        description: "CAN receive message failed"
        severity: "error"

      - name: "CAN_QUEUE_FULL"
        code: "0x0017"
        description: "CAN message queue overflow (messages dropped)"
        severity: "error"

      - name: "CAN1_RX_MSG"
        code: "0x0018"
        description: "CAN1 receive message failed"
        severity: "error"

      - name: "CAN2_RX_MSG"
        code: "0x0019"
        description: "CAN2 receive message failed"
        severity: "error"

      - name: "CAN3_RX_MSG"
        code: "0x001A"
        description: "CAN3 receive message failed"
        severity: "error"

      - name: "CAN4_RX_MSG"
        code: "0x001B"
        description: "CAN4 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN5_RX_MSG"
        code: "0x001C"
        description: "CAN5 receive message failed (reserved for future hardware)"
        severity: "error"

      - name: "CAN_RESERVED"
        code: "0x001D"
        description: "Reserved for future CAN errors"
        severity: "info"

  TIM:
    description: "Timer peripheral errors"
    source: "STM32_VCU"
    errors:
      - name: "TIM1"
        code: "0x001E"
        description: "Timer 1 operation failed"
        severity: "error"

      - name: "TIM2"
        code: "0x001F"
        description: "Timer 2 operation failed"
        severity: "error"

      - name: "TIM3"
        code: "0x0020"
        description: "Timer 3 operation failed"
        severity: "error"

      - name: "TIM4"
        code: "0x0021"
        description: "Timer 4 operation failed"
        severity: "error"

      - name: "TIM5"
        code: "0x0022"
        description: "Timer 5 operation failed"
        severity: "error"

      - name: "TIM6"
        code: "0x0023"
        description: "Timer 6 operation failed"
        severity: "error"

      - name: "TIM7"
        code: "0x0024"
        description: "Timer 7 operation failed"
        severity: "error"

      - name: "TIM8"
        code: "0x0025"
        description: "Timer 8 operation failed"
        severity: "error"

      - name: "TIM9"
        code: "0x0026"
        description: "Timer 9 operation failed"
        severity: "error"

      - name: "TIM10"
        code: "0x0027"
        description: "Timer 10 operation failed"
        severity: "error"

      - name: "TIM11"
        code: "0x0028"
        description: "Timer 11 operation failed"
        severity: "error"

      - name: "TIM12"
        code: "0x0029"
        description: "Timer 12 operation failed"
        severity: "error"

      - name: "TIM13"
        code: "0x002A"
        description: "Timer 13 operation failed"
        severity: "error"

  UART:
    description: "UART serial communication errors"
    source: "STM32_VCU"
    errors:
      - name: "UART1"
        code: "0x002B"
        description: "UART1 operation failed"
        severity: "error"

      - name: "UART2"
        code: "0x002C"
        description: "UART2 operation failed"
        severity: "error"

  VCU_GENERAL:
    description: "VCU general system errors"
    source: "STM32_VCU"
    errors:
      - name: "VCU_INIT"
        code: "0x002D"
        description: "VCU initialization failed"
        severity: "critical"

      - name: "FREERTOS_TASK_CREATE"
        code: "0x002E"
        description: "FreeRTOS task creation failed (insufficient heap memory)"
        severity: "critical"

      - name: "MEMORY_ALLOC"
        code: "0x002F"
        description: "Memory allocation failed (malloc returned NULL)"
        severity: "critical"

      - name: "DCDC"
        code: "0x0030"
        description: "DC-DC converter error"
        severity: "critical"

      - name: "BMS1"
        code: "0x0031"
        description: "BMS1 communication or fault"
        severity: "critical"

      - name: "BMS2"
        code: "0x0032"
        description: "BMS2 communication or fault"
        severity: "critical"

      - name: "BMS1_OVERVOLTAGE"
        code: "0x0033"
        description: "BMS1 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS1_UNDERVOLTAGE"
        code: "0x0034"
        description: "BMS1 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS1_EXCESSIVE_DELTA"
        code: "0x0035"
        description: "BMS1 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS1_DATA_FAULT"
        code: "0x0036"
        description: "BMS1 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS1_TIMEOUT"
        code: "0x0037"
        description: "BMS1 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS2_OVERVOLTAGE"
        code: "0x0038"
        description: "BMS2 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS2_UNDERVOLTAGE"
        code: "0x0039"
        description: "BMS2 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS2_EXCESSIVE_DELTA"
        code: "0x003A"
        description: "BMS2 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS2_DATA_FAULT"
        code: "0x003B"
        description: "BMS2 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS2_TIMEOUT"
        code: "0x003C"
        description: "BMS2 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "BMS3_OVERVOLTAGE"
        code: "0x003D"
        description: "BMS3 cell overvoltage detected (charging stopped)"
        severity: "critical"

      - name: "BMS3_UNDERVOLTAGE"
        code: "0x003E"
        description: "BMS3 cell undervoltage detected (fault condition)"
        severity: "critical"

      - name: "BMS3_EXCESSIVE_DELTA"
        code: "0x003F"
        description: "BMS3 cell voltage imbalance exceeds limit"
        severity: "warning"

      - name: "BMS3_DATA_FAULT"
        code: "0x0040"
        description: "BMS3 data invalid or corrupted (all cells zero)"
        severity: "critical"

      - name: "BMS3_TIMEOUT"
        code: "0x0041"
        description: "BMS3 communication timeout (no response to wake-up signals)"
        severity: "error"

      - name: "CHARGER1_OBC_TIMEOUT"
        code: "0x0042"
        description: "Charger 1 OBC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER1_DCDC_TIMEOUT"
        code: "0x0043"
        description: "Charger 1 DCDC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER1_TX_FAIL"
        code: "0x0044"
        description: "Charger 1 CAN transmission failed"
        severity: "warning"

      - name: "CHARGER1_OBC_FAULT"
        code: "0x0045"
        description: "Charger 1 OBC hardware or temperature fault"
        severity: "error"

      - name: "CHARGER1_DCDC_FAULT"
        code: "0x0046"
        description: "Charger 1 DCDC hardware fault"
        severity: "error"

      - name: "CHARGER2_OBC_TIMEOUT"
        code: "0x0047"
        description: "Charger 2 OBC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER2_DCDC_TIMEOUT"
        code: "0x0048"
        description: "Charger 2 DCDC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER2_TX_FAIL"
        code: "0x0049"
        description: "Charger 2 CAN transmission failed"
        severity: "warning"

      - name: "CHARGER2_OBC_FAULT"
        code: "0x004A"
        description: "Charger 2 OBC hardware or temperature fault"
        severity: "error"

      - name: "CHARGER2_DCDC_FAULT"
        code: "0x004B"
        description: "Charger 2 DCDC hardware fault"
        severity: "error"

      - name: "CHARGER3_OBC_TIMEOUT"
        code: "0x004C"
        description: "Charger 3 OBC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER3_DCDC_TIMEOUT"
        code: "0x004D"
        description: "Charger 3 DCDC communication timeout (>1s)"
        severity: "error"

      - name: "CHARGER3_TX_FAIL"
        code: "0x004E"
        description: "Charger 3 CAN transmission failed"
        severity: "warning"

      - name: "CHARGER3_OBC_FAULT"
        code: "0x004F"
        description: "Charger 3 OBC hardware or temperature fault"
        severity: "error"

      - name: "CHARGER3_DCDC_FAULT"
        code: "0x0050"
        description: "Charger 3 DCDC hardware fault"
        severity: "error"

      - name: "CHARGER4_OBC_TIMEOUT"
        code: "0x0051"
        description: "Charger 4 OBC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER4_DCDC_TIMEOUT"
        code: "0x0052"
        description: "Charger 4 DCDC communication timeout (>1s) [Reserved]"
        severity: "error"

      - name: "CHARGER4_TX_FAIL"
        code: "0x0053"
        description: "Charger 4 CAN transmission failed [Reserved]"
        severity: "warning"

      - name: "CHARGER4_OBC_FAULT"
        code: "0x0054"
        description: "Charger 4 OBC hardware or temperature fault [Reserved]"
        severity: "error"

      - name: "CHARGER4_DCDC_FAULT"
        code: "0x0055"
        description: "Charger 4 DCDC hardware fault [Reserved]"
        severity: "error"

      - name: "CHARGER_IGNITION_ON"
        code: "0x0056"
        description: "Charging blocked: ignition ON (vehicle operational)"
        severity: "critical"

      - name: "CHARGER_NOT_NEUTRAL"
        code: "0x0057"
        description: "Charging blocked: transmission not in neutral"
        severity: "critical"

      - name: "CHARGER_VEHICLE_MOVING"
        code: "0x0058"
        description: "Charging blocked: vehicle moving (RPM detected)"
        severity: "critical"

  MOTOR_LDU:
    description: "Motor controller and LDU errors"
    source: "LDU_MOTOR"
    can_id: "0x108"
    errors:
      - name: "MOTOR_OVERCURRENT"
        code: "0x0059"
        description: "Motor phase overcurrent detected"
        severity: "critical"
        sine_error_code: 1
        sine_error_name: "ERR_OVERCURRENT"
        sine_error_type: "ERROR_STOP"
        action: "Motor will shut down immediately"

      - name: "MOTOR_THROTTLE1"
        code: "0x005A"
        description: "Throttle sensor 1 fault"
        severity: "warning"
        sine_error_code: 2
        sine_error_name: "ERR_THROTTLE1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_THROTTLE2"
        code: "0x005B"
        description: "Throttle sensor 2 fault"
        severity: "warning"
        sine_error_code: 3
        sine_error_name: "ERR_THROTTLE2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check throttle pedal wiring"

      - name: "MOTOR_CANTIMEOUT"
        code: "0x005C"
        description: "Motor CAN communication timeout"
        severity: "critical"
        sine_error_code: 4
        sine_error_name: "ERR_CANTIMEOUT"
        sine_error_type: "ERROR_STOP"
        action: "Check CAN bus connections"

      - name: "MOTOR_EMCYSTOP"
        code: "0x005D"
        description: "Emergency stop triggered"
        severity: "critical"
        sine_error_code: 5
        sine_error_name: "ERR_EMCYSTOP"
        sine_error_type: "ERROR_STOP"
        action: "Check emergency stop circuit"

      - name: "MOTOR_MPROT"
        code: "0x005E"
        description: "Motor protection fault"
        severity: "critical"
        sine_error_code: 6
        sine_error_name: "ERR_MPROT"
        sine_error_type: "ERROR_STOP"
        action: "Motor protection triggered"

      - name: "MOTOR_DESAT"
        code: "0x005F"
        description: "Desaturation fault"
        severity: "critical"
        sine_error_code: 7
        sine_error_name: "ERR_DESAT"
        sine_error_type: "ERROR_STOP"
        action: "IGBT desaturation detected"

      - name: "MOTOR_OVERVOLTAGE"
        code: "0x0060"
        description: "DC bus overvoltage"
        severity: "critical"
        sine_error_code: 8
        sine_error_name: "ERR_OVERVOLTAGE"
        sine_error_type: "ERROR_STOP"
        action: "DC bus voltage too high"

      - name: "MOTOR_ENCODER"
        code: "0x0061"
        description: "Encoder failure"
        severity: "warning"
        sine_error_code: 9
        sine_error_name: "ERR_ENCODER"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder connections"

      - name: "MOTOR_PRECHARGE"
        code: "0x0062"
        description: "Precharge fault"
        severity: "critical"
        sine_error_code: 10
        sine_error_name: "ERR_PRECHARGE"
        sine_error_type: "ERROR_STOP"
        action: "Precharge circuit failed"

      - name: "MOTOR_TMPHSMAX"
        code: "0x0063"
        description: "Heatsink overtemperature"
        severity: "warning"
        sine_error_code: 11
        sine_error_name: "ERR_TMPHSMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CURRENTLIMIT"
        code: "0x0064"
        description: "Current limit active"
        severity: "warning"
        sine_error_code: 12
        sine_error_name: "ERR_CURRENTLIMIT"
        sine_error_type: "ERROR_DERATE"
        action: "Motor power limited"

      - name: "MOTOR_PWMSTUCK"
        code: "0x0065"
        description: "PWM stuck fault"
        severity: "warning"
        sine_error_code: 13
        sine_error_name: "ERR_PWMSTUCK"
        sine_error_type: "ERROR_DISPLAY"
        action: "PWM output failure"

      - name: "MOTOR_HICUROFS1"
        code: "0x0066"
        description: "Current sensor 1 offset high"
        severity: "warning"
        sine_error_code: 14
        sine_error_name: "ERR_HICUROFS1"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 1"

      - name: "MOTOR_HICUROFS2"
        code: "0x0067"
        description: "Current sensor 2 offset high"
        severity: "warning"
        sine_error_code: 15
        sine_error_name: "ERR_HICUROFS2"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate current sensor 2"

      - name: "MOTOR_HIRESOFS"
        code: "0x0068"
        description: "High-res encoder offset fault"
        severity: "warning"
        sine_error_code: 16
        sine_error_name: "ERR_HIRESOFS"
        sine_error_type: "ERROR_DISPLAY"
        action: "Calibrate high-res encoder"

      - name: "MOTOR_LORESAMP"
        code: "0x0069"
        description: "Low-res encoder amplitude fault"
        severity: "warning"
        sine_error_code: 17
        sine_error_name: "ERR_LORESAMP"
        sine_error_type: "ERROR_DISPLAY"
        action: "Check encoder signal quality"

      - name: "MOTOR_TMPMMAX"
        code: "0x006A"
        description: "Motor overtemperature"
        severity: "warning"
        sine_error_code: 18
        sine_error_name: "ERR_TMPMMAX"
        sine_error_type: "ERROR_DERATE"
        action: "Motor will derate power"

      - name: "MOTOR_CANCRC"
        code: "0x006B"
        description: "Motor CAN CRC error"
        severity: "critical"
        sine_error_code: 19
        sine_error_name: "ERR_CANCRC"
        sine_error_type: "ERROR_STOP"
        action: "CAN message corrupted"

      - name: "MOTOR_CANCOUNTER"
        code: "0x006C"
        description: "Motor CAN counter mismatch"
        severity: "critical"
        sine_error_code: 20
        sine_error_name: "ERR_CANCOUNTER"
        sine_error_type: "ERROR_STOP"
        action: "CAN message sequence error"

